#to enable CommandBox for a server: include commandbox.conf;

#block the lucee-context except for certain ip
location ~* /lucee/ {
	allow 127.0.0.1;
	allow 104.131.152.151;
	deny all;
	include commandbox-proxy.conf;
}

location ~* /lucee-server {
	return 404;
}

#block/ignore CFIDE requests
location ~* /CFIDE {
	return 404;
}

#block requests for Application.cfc/cfm
location ~* Application.cf[mc]$ {
	return 404;
}

#block requests for known bad extensions; update this pipe-delimited list with other extensions to blacklist
location ~ \.(aspx|php|jsp|cgi|env)$ {
    	return 410;
}

#set the default document to index.html or index.cfm
index index.html index.cfm;

################### REWRITE: SES RULES #####################
	# Rewrite for URL Mappings
	# If you don't use SES urls you could do something like this
	# location ~ \.(cfm|cfml|cfc)(.*)$ {
################### LOCATION: ROOT #####################

location / {
	# First attempt to serve request as file or directory, else it sends it to the @rewrite location
	try_files $uri $uri/ @rewrite;
}

location @rewrite {
	rewrite ^/(.*)? /index.cfm/$request_uri last;
	rewrite ^ /index.cfm last;
}
